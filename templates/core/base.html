{% load static %} {% load custom_tags %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>{% block title %}{% endblock title %} | iRead</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    {% if meta_post %}
    {% if post.canonical_url %}
    <link rel="canonical" href="{{post.canonical_url}}" />
    {% endif %}
    <meta name="title" content="{{post.title}} | iRead" />
    <meta name="description" content="{{post.seo_overview}}" />
    <meta property="og:title" content="{{post.title}} | iRead" />
    <meta property="og:description" content="{{post.seo_overview}}" />
    <meta property="og:image" content="{{post.thumbnail.url}}" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@iRead_Blog" />
    <meta name="twitter:title" content="{{post.title}} | iRead" />
    <meta name="twitter:description" content="{{post.seo_overview}}" />
    <meta name="twitter:image" content="{{post.thumbnail.url}}" />
    <meta
      name="keywords"
      content="iread,blog,iread blog,{{meta_keywords}}"
    />
    {% elif meta_series %}
    <meta name="title" content="{{series.name}} | iRead" />
    <meta name="description" content="{{series.desc}}" />
    <meta property="og:title" content="{{series.name}} | iRead" />
    <meta property="og:description" content="{{series.desc}}" />
    <meta property="og:image" content="{{series.thumbnail.url}}" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@iRead_Blog" />
    <meta name="twitter:title" content="{{series.name}} | iRead" />
    <meta name="twitter:description" content="{{series.desc}}" />
    <meta name="twitter:image" content="{{series.thumbnail.url}}" />
    {% else %}
    <meta name="title" content="{{title}} | iRead" />
    <meta
      name="keywords"
      content="iread,blog,iread blog,Python,software development, engineering, rails, javascript, ruby, django, flask, git, github,write"
    />
    <meta name="description" content="iRead is an open platform where readers find dynamic thinking, and where expert and undiscovered voices can share their writing on any topic." />
    <meta property="og:title" content="{{title}} | iRead" />
    <meta
      property="og:description"
      content="iRead is an open platform where readers find dynamic thinking, and where expert and undiscovered voices can share their writing on any topic."
    />
    <meta property="og:image" content="{% static 'images/favicon.png' %}" />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="iRead" />
    <meta property="og:image:type" content="image/jpg" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@iRead_Blog" />
    <meta name="twitter:title" content="{{title}} | iRead" />
    <meta name="twitter:description" content="iRead is an open platform where readers find dynamic thinking, and where expert and undiscovered voices can share their writing on any topic." />
    <meta name="twitter:image" content="{% static 'images/favicon.png' %}" />
    {% endif %}
    <meta name="robots" content="index, follow">
    <meta
      name="google-site-verification"
      content="kCaDsevOB107PNa52WhEleNVU7IrF7zFpT4prbTqrqM"
    />
    <link
      rel="shortcut icon"
      type="image/png"
      href="{% static 'images/favicon.png' %}"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/themes/prism-okaidia.css"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Josefin+Sans:300, 400,700|Inconsolata:400,700"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="{% static 'css/bootstrap.css' %}" />
    <link rel="stylesheet" href="{% static 'css/animate.css' %}" />
    <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <link rel="stylesheet" href="{% static 'css/simple-notify.min.css' %}" />
    <script src="{% static 'js/simple-notify.min.js' %}"></script>
    <link
      rel="stylesheet"
      href="{% static 'fonts/ionicons/css/ionicons.min.css' %}"
    />
    <link
      rel="stylesheet"
      href="{% static 'fonts/fontawesome/css/font-awesome.min.css' %}"
    />
    <link
      rel="stylesheet"
      href="{% static 'fonts/flaticon/font/flaticon.css' %}"
    />

    <!-- Theme Style -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/toolbar/prism-toolbar.css"
      rel="stylesheet"
    />

    <link
      href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/command-line/prism-command-line.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-core.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/highlight-keywords/prism-highlight-keywords.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/command-line/prism-command-line.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/toolbar/prism-toolbar.js"></script>
    {% block js_up %} {% endblock js_up %}

    <style>
      .separator {
        display: flex;
        align-items: center;
        text-align: center;
      }

      .separator::before,
      .separator::after {
        content: "";
        flex: 1;
        border-bottom: 1px solid #000;
      }

      .separator:not(:empty)::before {
        margin-right: 0.25em;
      }

      .separator:not(:empty)::after {
        margin-left: 0.25em;
      }

      .custom-loader {
        animation: none !important;
        border-width: 0 !important;
      }
      /*       ::-webkit-scrollbar{
        width: 15px;
      }
      ::-webkit-scrollbar-track{
        background-color: #4f4f4f;
        border-radius: 35px;
      }
      ::-webkit-scrollbar-thumb{
        background: #6610f2;
        border-radius: 35px;
      }
      ::-webkit-scrollbar-thumb:hover{
        background: #7600d1;
      } */
    </style>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-W9XT85E9BF"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-W9XT85E9BF");
    </script>
  </head>
  <body>
    <!-- Back to top button -->
    <button
            type="button"
            class="btn btn-danger btn-floating btn-lg"
            id="btn-back-to-top"
            >
      <i class="fa fa-arrow-up"></i>
    </button>

    <div class="wrap">
      <header role="banner">
        <div class="top-bar">
          <div class="container">
            <div class="row">
              {% if request.session.user_id %}
              <div class="col-9">{% show_notifications %}</div>
              {% else %}
              <div class="col-9 social">
                <a href="{{links.twitter}}"
                  ><span class="fa fa-twitter"></span
                ></a>
                <a href="{{links.facebook}}"
                  ><span class="fa fa-facebook"></span
                ></a>
                <a href="{{links.instagram}}"
                  ><span class="fa fa-instagram"></span
                ></a>
              </div>
              {% endif %}
  

              <div class="col-3 search-top">
                <!-- <a href="#"><span class="fa fa-search"></span></a> -->
                <form
                  action="{% url 'search' %}"
                  method="GET"
                  class="search-top-form"
                >
                  <span class="icon fa fa-search"></span>
                  <input
                    type="text"
                    id="s"
                    name="query"
                    placeholder="Type keyword and press enter to search..."
                  />
                </form>
              </div>
            </div>
          </div>
        </div>

        <div class="container logo-wrap">
          <div class="row pt-5">
            <div class="col-12 text-center">
              <a
                class="absolute-toggle d-block d-md-none"
                data-toggle="collapse"
                href="#navbarMenu"
                role="button"
                aria-expanded="false"
                aria-controls="navbarMenu"
                ><span class="burger-lines"></span
              ></a>
              <h1 class="site-logo"><a href="{% url 'home' %}">iRead</a></h1>
            </div>
          </div>
        </div>

        <nav class="navbar navbar-expand-md navbar-light bg-light">
          <div class="container">
            <div class="collapse navbar-collapse" id="navbarMenu">
              <ul class="navbar-nav mx-auto">
                <li class="nav-item">
                  <a class="nav-link" id="home" href="{% url 'home' %}">Home</a>
                </li>
                {% if request.session.user_id %}
                <li class="nav-item">
                  <a class="nav-link" id="new_post" href="{% url 'new_post' %}"
                    >Create Post</a
                  >
                </li>
                <li class="nav-item dropdown">
                  <a
                    class="nav-link dropdown-toggle"
                    id="category"
                    id="dropdown05"
                    data-toggle="dropdown"
                    aria-haspopup="true"
                    aria-expanded="false"
                    >Account</a
                  >
                  <div class="dropdown-menu" aria-labelledby="dropdown05">
                    <a
                      class="dropdown-item"
                      href="{% url 'profile' request.session.username %}"
                      >View Profile</a
                    >
                    <a class="dropdown-item" href="{% url 'new_series' %}"
                      >Create New Series</a
                    >
                    <a href="{% url 'user_post_feed' request.session.username %}" class="dropdown-item" target="_blank">
                      RSS Feed
                    </a>
                    <a href="{% url 'stats' request.session.username %}" class="dropdown-item">
                      Your Stats
                    </a>
                    <a class="dropdown-item" href="{% url 'change_password' %}"
                      >Change Password</a
                    >
                    <a class="dropdown-item" href="{% url 'logout' %}"
                      >Log Out</a
                    >
                  </div>
                </li>
                {% endif %}
                <li class="nav-item dropdown">
                  <a
                    class="nav-link dropdown-toggle"
                    id="category"
                    id="dropdown05"
                    data-toggle="dropdown"
                    aria-haspopup="true"
                    aria-expanded="false"
                    >Categories</a
                  >
                  <div class="dropdown-menu" aria-labelledby="dropdown05">
                    {% for category in categories %}
                    <a
                      class="dropdown-item"
                      href="{% url 'category' category.name %}"
                      >{{category}}</a
                    >
                    {% endfor %}
                  </div>
                </li>
                <li class="nav-item">
                  <a class="nav-link" id="about" href="{% url 'about' %}"
                    >About</a
                  >
                </li>
                <li class="nav-item">
                  <a
                    class="nav-link"
                    id="bulletin"
                    href="https://digests.ireadblog.com"
                    target="_blank"
                    style="cursor: pointer"
                    >Bulletins</a
                  >
                </li>
                <li class="nav-item">
                  <a class="nav-link" id="contact" href="{% url 'contact' %}"
                    >Contact</a
                  >
                </li>
                <li class="nav-item">
                  <a class="nav-link" id="sponsor" href="{% url 'dashboard' %}"
                    >Sponsor</a
                  >
                </li>
                {% if not request.session.user_id %}
                <li class="nav-item">
                  <a class="nav-link" id="signup" href="{% url 'signup' %}"
                    >Sign Up</a
                  >
                </li>
                <li class="nav-item">
                  <a class="nav-link" id="login" href="{% url 'login' %}"
                    >Log In</a
                  >
                </li>
                {% endif %}
              </ul>
            </div>
          </div>
        </nav>
      </header>
      <!-- END header -->

      

      {% block content %} {% endblock content %}
      <footer class="site-footer">
        <div class="container">
          <div class="row">
            <div class="col-md-12 text-center">
              <a href="{% url 'home' %}">Home</a> &bullet;
              <a href="{% url 'new_post' %}">Write on iRead</a> &bullet;
              <a href="{% url 'about' %}">About Us</a> &bullet;
              <a href="{% url 'contact' %}">Contact</a> <br />
              <a href="{% url 'dashboard' %}">Sponsor</a> &bullet;
              <a href="{% url 'privacy_policy' %}">Privacy Policy</a> &bullet;
              <a href="{% url 'terms_conditions' %}">T&C</a> &bullet;
              <a href="{% url 'refund_policy' %}">Refund Policy</a>
              <center><hr width="50%" /></center>
              <a href="{{links.twitter}}" target="_blank"
                ><span class="fa fa-twitter">&nbsp;&nbsp;</span></a
              >
              <a href="{{links.facebook}}" target="_blank"
                ><span class="fa fa-facebook"></span>&nbsp;&nbsp;</a
              >
              <a href="{{links.instagram}}" target="_blank"
                ><span class="fa fa-instagram"></span>&nbsp;&nbsp;</a
              >
              <a href="{% url 'post_feed' %}" target="_blank"
                ><span class="fa fa-rss"></span>&nbsp;&nbsp;</a
              >
              <br />
              <a
                href="https://www.producthunt.com/posts/iread?utm_source=badge-featured&utm_medium=badge&utm_souce=badge-iread"
                target="_blank"
                ><img
                  src="https://api.producthunt.com/widgets/embed-image/v1/featured.svg?post_id=304112&theme=light"
                  alt="iRead - Where dynamic ideas find you | Product Hunt"
                  style="margin-top: 20px; width: 250px; height: 54px"
                  width="250"
                  height="54"
              /></a>
              <p class="small">
                <br />
                <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                iRead &copy; 2021
                <script>
                  new Date().getFullYear() > 2021 &&
                    document.write("- " + new Date().getFullYear());
                </script>
                , All Rights Reserved <br />
                This template is made with
                <i class="fa fa-heart text-danger" aria-hidden="true"></i> by
                <a href="https://colorlib.com" target="_blank">Colorlib</a> and
                powered by
                <a href="https://www.djangoproject.com/" target="_blank"
                  >Django</a
                >.
                <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
              </p>
            </div>
          </div>
        </div>
      </footer>
      <!-- END footer -->
    </div>
    <!-- loader -->
    <div id="loader" class="show fullscreen">
      <svg class="circular" width="48px" height="48px">
        <circle
          class="path-bg"
          cx="24"
          cy="24"
          r="22"
          fill="none"
          stroke-width="4"
          stroke="#eeeeee"
        />
        <circle
          class="path"
          cx="24"
          cy="24"
          r="22"
          fill="none"
          stroke-width="4"
          stroke-miterlimit="10"
          stroke="#f4b214"
        />
      </svg>
    </div>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0"
      crossorigin="anonymous"
    ></script>
    <!-- <script src="{% static 'js/jquery-3.2.1.min.js' %}"></script> -->
    <script src="{% static 'js/jquery-migrate-3.0.0.js' %}"></script>
    <script src="{% static 'js/popper.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <script src="{% static 'js/owl.carousel.min.js' %}"></script>
    <script src="{% static 'js/jquery.waypoints.min.js' %}"></script>
    <script src="{% static 'js/jquery.stellar.min.js' %}"></script>

    <script src="{% static 'js/main.js' %}"></script>
    <script>
      $(".bulletin").click(function (e) {
        Swal.fire({
          title: "Enjoy Our Bulletins",
          html: `
        <br>
        <a href="http://feeds.feedburner.com/ireadblog" title="Subscribe to our feed" rel="alternate" type="application/rss+xml"><img src="https://feedburner.google.com/fb/images/pub/feed-icon32x32.png" alt="" style="border:0"/></a><a href="http://feeds.feedburner.com/ireadblog" title="Subscribe to iRead feed" rel="alternate" type="application/rss+xml"> Subscribe in a reader</a>
        <p class="mt-3"><strong>OR</strong></p>
        <form action="" method="POST" id="bltForm">
          {% csrf_token %}
          <input type="text" id="name" name="name" class="swal2-input" placeholder="Name">
        <input type="email" id="email" name="email" class="swal2-input" placeholder="Email address">
        <select name="category" id="category" class="swal2-input">
          <option disabled selected>Select Category</option>
        {% for cat in categories %}
          <option value="{{cat.id}}">{{cat}}</option>
        {% endfor %}
        </select>
        <select name="recurring" id="recurring" class="swal2-input">
          <option disabled selected>Select Type</option>
        {% for rec in recurrings %}
          <option value="{{rec.id}}">{{rec}}</option>
        {% endfor %}
        </select>
        </form>
        `,
          confirmButtonText: "Subscribe",
          focusConfirm: false,
          customClass: {
            confirmButton: "btn btn-primary btn-lg",
          },
          preConfirm: () => {
            const email = Swal.getPopup().querySelector("#email").value;
            const name = Swal.getPopup().querySelector("#name").value;
            const category = Swal.getPopup().querySelector("#category").value;
            const recurring = Swal.getPopup().querySelector("#recurring").value;
            const csrftoken = $("input[name=csrfmiddlewaretoken]").val();
            var pattern = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;
            if (!email) {
              Swal.showValidationMessage(`Email address is missing.`);
            } else if (String(email).search(pattern) == -1) {
              Swal.showValidationMessage(`Enter a valid email address`);
            } else if (!name) {
              Swal.showValidationMessage(`Name is missing`);
            } else if (!category) {
              Swal.showValidationMessage(`Category is missing`);
            } else if (!recurring) {
              Swal.showValidationMessage(`Type is missing`);
            }
            return {
              email: email,
              name: name,
              category: category,
              recurring: recurring,
              csrftoken: csrftoken,
            };
          },
        }).then((result) => {
          if (result.value) {
            fetch("/bulletins/subscribe", {
              body: JSON.stringify({
                email: result.value.email,
                name: result.value.name,
                category: result.value.category,
                recurring: result.value.recurring,
              }),
              headers: {
                "X-CSRFToken": result.value.csrftoken,
              },
              method: "POST",
            })
              .then((res) => res.json())
              .then((data) => {
                if (data.registration_duplicate) {
                  Swal.fire({
                    icon: "error",
                    title: "Already Subscribed",
                    text: `You've already subscribed to our bulletins`,
                  });
                } else if (data.registration_success) {
                  Swal.fire({
                    icon: "success",
                    title: "Subscribed",
                    html: `We'll send you <strong>${
                      data.category
                    }</strong> related bulletins ${data.recurring.toLowerCase()}`,
                  });
                } else {
                  Swal.fire({
                    icon: "error",
                    title: "Oops..",
                    text: `We've encountered some error while subscribing. Please try again.`,
                  });
                }
              });
          }
        });
      });
    </script>
    <script src="{% static 'js/notification.js' %}"></script>
    {% if error %}
    <script>
      new Notify({
        title: "Error",
        text: `{{error|safe}}`,
        status: "error",
        effect: "slide",
      });
    </script>
    {% endif %} {% if message %}
    <script>
      new Notify({
        title: "Success",
        text: `{{message|safe}}`,
        status: "success",
        effect: "slide",
      });
    </script>
    {% endif %} {% block js_down %} {% endblock js_down %}
  </body>
</html>
